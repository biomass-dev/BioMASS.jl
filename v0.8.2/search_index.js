var documenterSearchIndex = {"docs":
[{"location":"references/","page":"References","title":"References","text":"Imoto, H., Zhang, S. & Okada, M. A Computational Framework for Prediction and Analysis of Cancer Signaling Dynamics from RNA Sequencing Data—Application to the ErbB Receptor Signaling Pathway. Cancers 12, 2878 (2020). https://doi.org/10.3390/cancers12102878\nImoto, H., Yamashiro, S. & Okada, M. A text-based computational framework for patient -specific modeling for classification of cancers. iScience 25, 103944 (2022). https://doi.org/10.1016/j.isci.2022.103944\nNakakuki, T. et al. Ligand-specific c-Fos expression emerges from the spatiotemporal control of ErbB network dynamics. Cell 141, 884–896 (2010). https://doi.org/10.1016/j.cell.2010.03.054\nYao, G., Lee, T. J., Mori, S., Nevins, J. R. & You, L. A bistable Rb-E2F switch underlies the restriction point. Nat. Cell Biol. 10, 476–482 (2008). https://doi.org/10.1038/ncb1711\nBarr, A. R., Heldt, F. S., Zhang, T., Bakal, C. & Novák, B. A Dynamical Framework for the All-or-None G1/S Transition. Cell Syst. 2, 27–37 (2016). https://doi.org/10.1016/j.cels.2016.01.001\nRata, S. et al. Two Interlinked Bistable Switches Govern Mitotic Control in Mammalian Cells. Curr. Biol. 28, 3824-3832.e6 (2018). https://doi.org/10.1016/j.cub.2018.09.059","category":"page"},{"location":"usage/model_construction/#Model-Construction","page":"Model Construction","title":"Model Construction","text":"","category":"section"},{"location":"usage/model_construction/","page":"Model Construction","title":"Model Construction","text":"pasmopy.Text2Model allows you to build a BioMASS model from text. You simply describe biochemical reactions and the molecular mechanisms extracted from text are converted into an executable model.","category":"page"},{"location":"usage/model_construction/#Example","page":"Model Construction","title":"Example","text":"","category":"section"},{"location":"usage/model_construction/","page":"Model Construction","title":"Model Construction","text":"This example shows you how to build a simple Michaelis-Menten two-step enzyme catalysis model with Pasmopy.","category":"page"},{"location":"usage/model_construction/","page":"Model Construction","title":"Model Construction","text":"E + S ⇄ ES → E + P","category":"page"},{"location":"usage/model_construction/","page":"Model Construction","title":"Model Construction","text":"An enzyme, E, binding to a substrate, S, to form a complex, ES, which in turn releases a product, P, regenerating the original enzyme.","category":"page"},{"location":"usage/model_construction/","page":"Model Construction","title":"Model Construction","text":"Prepare a text file describing biochemical reactions (e.g., michaelis_menten.txt)\n```  E binds S <–> ES | kf=0.003, kr=0.001 | E=100, S=50  ES dissociates to E and P | kf=0.002, kr=0\n@obs Substrate: u[S]  @obs Efree: u[E]  @obs Etotal: u[E] + u[ES]  @obs Product: u[P]  @obs Complex: u[ES]\n@sim tspan: [0, 100]  ```\nConvert the text into an executable model\nshell  $ python  ```python\nfrom pasmopy import Text2Model description = Text2Model(\"michaelismenten.txt\", lang=\"julia\") description.convert()  # generate 'michaelismenten_jl/'\nModel information\n2 reactions  4 species  4 parameters  ```\nRun simulation\nshell  $ julia  ```julia  using BioMASS\nmodel = Model(\"./michaelismentenjl\");  run_simulation(model)  ```\n(Image: michaelis_menten)","category":"page"},{"location":"usage/bifurcation_analysis/#Bifurcation-Analysis","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"A numerical study of the changes in the dynamics and stability of a system upon variations in its parameters.","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"(Image: )","category":"page"},{"location":"usage/bifurcation_analysis/#Procedure-for-stability-analysis-at-fixed-points","page":"Bifurcation Analysis","title":"Procedure for stability analysis at fixed points","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"Consider the following system of ordinary differential equations:","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"dfracdxdt = F(x)","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"Determine the fixed point vector, x^*, solving F(x^*) = 0\nConstruct the Jacobian matrix, J(x) = dfracpartial F(x)partial x\nCompute eigenvalues of J(x^*): J(x^*)  λE = 0\nConclude on stability or instability of x^* based on the real parts of eigenvalues\nAll eigenvalues have real parts less than zero → x^* is stable\nAt least one of the eigenvalues has a real part greater than zero → x^* is unstable","category":"page"},{"location":"usage/bifurcation_analysis/#Usage","page":"Bifurcation Analysis","title":"Usage","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"Here I would like to use a mathematical model of Rb–E2F pathway (Yao et al., 2008) to show you how to perform bifurcation analysis with BioMASS.jl.","category":"page"},{"location":"usage/bifurcation_analysis/#Prepare-name2idx/-to-define-model-species-and-parameters","page":"Bifurcation Analysis","title":"Prepare name2idx/ to define model species and parameters","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"See examples.","category":"page"},{"location":"usage/bifurcation_analysis/#Create-[set_model.jl](https://github.com/biomass-dev/BioMASS.jl/blob/master/examples/bifurcation/restriction_point/set_model.jl)","page":"Bifurcation Analysis","title":"Create set_model.jl","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"In this file, you will need to prepare four functions:","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"diffeq!: Ordinary differential equations of the model.\nparam_values: Model parameters.\nget_derivatives: dfracpartial F(x)partial bp, where bp is the bifurcation parameter (x-axis).\nget_steady_state: Function to equilibrate the system.","category":"page"},{"location":"usage/bifurcation_analysis/#Run-create_diffeq-function","page":"Bifurcation Analysis","title":"Run create_diffeq function","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"create_diffeq(\".\")","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"Then you will get forwarddiff.jl file in your model folder.","category":"page"},{"location":"usage/bifurcation_analysis/#Load-requirements","page":"Bifurcation Analysis","title":"Load requirements","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"using DelimitedFiles\nusing Sundials\nusing SteadyStateDiffEq\nusing PyPlot\n\ninclude(\"./name2idx/parameters.jl\")\ninclude(\"./name2idx/species.jl\")\ninclude(\"./set_model.jl\")\ninclude(\"./forwarddiff.jl\")\n\nconst BP = C.S      # name(index) of bifurcation parameter (x-axis)\n\nconst SN = V.NUM    # num of state variables\nconst PN = 1        # num of parameters\nconst VN = SN + PN  # num of variables","category":"page"},{"location":"usage/bifurcation_analysis/#Calculate-fixed-points-and-analyze-their-stability","page":"Bifurcation Analysis","title":"Calculate fixed points and analyze their stability","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"After executing new_curve! function, you will get data/fp.dat and data/ev.dat files, where they contain fixed points and eigenvalues, respectively.","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"function calc_fixed_point_vec(model_path::String)::Tuple{Array,Array}\n    global p = param_values()\n    new_curve!(\n        model_path, p, diffeq, get_derivatives, get_steady_state,\n        direction=false, bifparam=BP, n_state=SN\n    )\n    fp::Array = readdlm(joinpath(model_path, \"data\", \"fp.dat\"), '\\t', Float64, '\\n')\n    ev::Array = readdlm(joinpath(model_path, \"data\", \"ev.dat\"), '\\t', Float64, '\\n')\n    br::Array = get_bistable_regime(ev, SN)\n\n    return fp, br\nend","category":"page"},{"location":"usage/bifurcation_analysis/#Plot-results","page":"Bifurcation Analysis","title":"Plot results","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"function bifurcation_diagram(model_path::String, fp::Array, br::Array)\n    rc(\"figure\", figsize=(8, 6))\n    rc(\"font\", family=\"Arial\")\n    rc(\"font\", size=24)\n    rc(\"axes\", linewidth=1)\n    rc(\"xtick.major\", width=1)\n    rc(\"ytick.major\", width=1)\n    rc(\"lines\", linewidth=3)\n\n    plot(fp[1:br[1]-1, VN+1], fp[1:br[1]-1, V.E+1], \"k-\")\n    plot(fp[br, VN+1], fp[br, V.E+1], lw=1.5, \"k--\")\n    plot(fp[br[end]+1:end, VN+1], fp[br[end]+1:end, V.E+1], \"k-\")\n\n    xlabel(\"Serum (percentage)\")\n    ylabel(\"E2F (μM)\")\n\n    xlim(0, 2)\n    xticks([0, 0.5, 1, 1.5, 2])\n    yscale(\"log\")\n    ylim(1e-4, 2)\n    yticks([1e-4, 1e-2, 1])\n\n    savefig(joinpath(model_path, \"bifurcation_diagram.pdf\"), bbox_inches=\"tight\")\n    close()\nend","category":"page"},{"location":"usage/bifurcation_analysis/#Run-all-functions-defined-above","page":"Bifurcation Analysis","title":"Run all functions defined above","text":"","category":"section"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"const MODEL_PATH = \".\"\n\nfp, br = calc_fixed_point_vec(MODEL_PATH);\nbifurcation_diagram(MODEL_PATH, fp, br);","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"(Image: )","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"Stable (solid) and unstable (dashed) steady states of E2F activity with respect to serum stimulation.","category":"page"},{"location":"usage/bifurcation_analysis/","page":"Bifurcation Analysis","title":"Bifurcation Analysis","text":"For more examples, please refer to examples/bifurcation.","category":"page"},{"location":"usage/parameter_estimation/#Parameter-Estimation","page":"Parameter Estimation","title":"Parameter Estimation","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"(Image: )","category":"page"},{"location":"usage/parameter_estimation/#Core-functions","page":"Parameter Estimation","title":"Core functions","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"","category":"page"},{"location":"usage/parameter_estimation/#Model(path_to_model::String)","page":"Parameter Estimation","title":"Model(path_to_model::String)","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Load a BioMASS model. The model must include the following files:","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Name Content\nname2idx/ Names of model parameters and species\node.jl Differential equation, parameters and initial condition\nobservalbe.jl Model observables for correlating simulation results with experimental observations\nsimulation.jl Simulation condition\nexperimental_data.jl Experimental measurements\nsearch_param.jl Lower and upper bounds of model parameters to be estimated\nproblem.jl An objective function to be minimized, i.e., the distance between model simulation and experimental data","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Parameters\npath_to_model::String\nThe model folder to read.\nReturns\nmodel::Model\nThe executable model in BioMASS.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"note: Note\npasmopy.Text2Model allows you to build a BioMASS model from text [Imoto et al., 2022]. You simply describe biochemical reactions and the molecular mechanisms extracted from text are converted into an executable model. To build a model for BioMASS.jl, please set lang=\"julia\".","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"","category":"page"},{"location":"usage/parameter_estimation/#scipy_differential_evolution(model::Model,-ix_id::Int,-kwargs...)","page":"Parameter Estimation","title":"scipy_differential_evolution(model::Model, ix_id::Int, kwargs...)","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Estimate model parameters from experimental data.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Parameters\nmodel::Model\nModel for parameter estimation.\nx_id::Int\nIndex of parameter set to estimate.\nkwargs...\nKeyword arguments to pass to scipy.optimize.differential_evolution.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"","category":"page"},{"location":"usage/parameter_estimation/#run_simulation(model::Model,-viz_type::String,-show_all::Boolfalse,-stdev::Boolfalse)","page":"Parameter Estimation","title":"run_simulation(model::Model, viz_type::String, show_all::Bool=false, stdev::Bool=false)","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Save simulation results with optimized parameter values.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Parameters\nviz_type::String\n\"average\"\n\"best\"\n\"original\"\n\"experiment\"\nshow_all::Bool (default: false)\nWhether to show all simulation results.\nstdev::Bool (default: false)\nIf True, the standard deviation of simulated values will be shown (only available for \"average\" visualization type).\nsave_format::String (default: \"pdf\")\nEither \"png\" or \"pdf\", indicating whether to save figures as png or pdf format.","category":"page"},{"location":"usage/parameter_estimation/#Estimate-unknown-model-parameters","page":"Parameter Estimation","title":"Estimate unknown model parameters","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"using BioMASS\n\nmodel = Model(\"./examples/fos_model\");\ninitpop = generate_initial_population(model)\nscipy_differential_evolution(model, 1, init=initpop)","category":"page"},{"location":"usage/parameter_estimation/#Simultaneous-parameter-optimization","page":"Parameter Estimation","title":"Simultaneous parameter optimization","text":"","category":"section"},{"location":"usage/parameter_estimation/#Using-module-Distributed","page":"Parameter Estimation","title":"Using module Distributed","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"using Distributed\naddprocs(); # add worker processes\n@everywhere using BioMASS\n\n@everywhere begin\n    model = Model(\"./examples/fos_model\")\n    function optimize_parallel(i)\n        scipy_differential_evolution(model, i)\n    end\nend\n\npmap(optimize_parallel, 1:10)","category":"page"},{"location":"usage/parameter_estimation/#Calling-multiple-bash-scripts","page":"Parameter Estimation","title":"Calling multiple bash scripts","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"main.jl","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"using BioMASS\n\nmodel = Model(\"./examples/fos_model\")\n\nif abspath(PROGRAM_FILE) == @__FILE__\n    scipy_differential_evolution(model, parse(Int64, ARGS[1]))\nend","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"optimize_parallel.sh","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"#!/bin/sh\n\nfor i in $(seq 1 10); do\n    nohup julia main.jl $i >> errout/$i.log  2>&1 &\ndone\n\n# To terminate the process,\n# $ pgrep -f main.jl | xargs kill -9","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"Run optimize_parallel.sh","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"$ mkdir errout\n$ sh optimize_parallel.sh","category":"page"},{"location":"usage/parameter_estimation/#How-to-track-optimization-process","page":"Parameter Estimation","title":"How to track optimization process","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"The temporary result will be saved in path_to_model/fitparam/n/optimization.log.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"$ tail examples/fos_model/fitparam/1/optimization.log","category":"page"},{"location":"usage/parameter_estimation/#Visualization-of-simulation-results","page":"Parameter Estimation","title":"Visualization of simulation results","text":"","category":"section"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"The simulation results will be saved in figure/.","category":"page"},{"location":"usage/parameter_estimation/","page":"Parameter Estimation","title":"Parameter Estimation","text":"run_simulation(model, viz_type=\"best\", show_all=true)","category":"page"},{"location":"#BioMASS.jl","page":"Home","title":"BioMASS.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"(Image: License: MIT) (Image: Source) (Image: Actions Status) (Image: Cancers Paper)","category":"page"},{"location":"","page":"Home","title":"Home","text":"This module provides a Julia interface to the BioMASS parameter estimation.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The open access publication describing BioMASS is available here:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Imoto, H., Zhang, S. & Okada, M. A Computational Framework for Prediction and Analysis of Cancer Signaling Dynamics from RNA Sequencing Data—Application to the ErbB Receptor Signaling Pathway. Cancers 12, 2878 (2020). https://doi.org/10.3390/cancers12102878","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"] add BioMASS","category":"page"},{"location":"","page":"Home","title":"Home","text":"    Pages = [\n        \"usage/parameter_estimation.md\",\n        \"usage/bifurcation_analysis.md\",\n    ]\n    Depth = 3","category":"page"}]
}
